<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>チュオン・トゥイ・ハム 514号室の意見箱</title>

<style>
body{
    margin:0;
    background:black;
    color:white;
    font-family: serif;
    text-align:center;
    transition: background 0.5s;
}

.container{
    margin-top:15vh;
}

input{
    padding:10px;
    width:250px;
    background:black;
    border:1px solid red;
    color:white;
    font-size:16px;
}

button{
    padding:10px 15px;
    background:red;
    color:white;
    border:none;
    cursor:pointer;
}

#response{
    margin-top:30px;
    font-size:18px;
    min-height:40px;
}

/* ===== ADDED FADE EFFECT ===== */
.fade-out{
    animation: fadeOut 3s forwards;
}

@keyframes fadeOut{
    from{ opacity:1; }
    to{ opacity:0; }
}
</style>
</head>

<body>

<div class="container">
    <h1 id="title">チュオン・トゥイ・ハム 514号室の意見箱</h1>
    <input id="userInput" placeholder="Enter your wish">
    <button id="submitBtn" onclick="reply()">Submit</button>
    <div id="response"></div>
</div>

<script>

// ===== TIME CHECK (00:00 - 01:00 RED MODE) =====
function checkMidnightMode(){
    const now = new Date();
    const hour = now.getHours();

    if(hour === 0){
        document.body.style.color = "red";
        document.getElementById("title").style.color = "red";
        document.getElementById("response").style.color = "red";
        document.getElementById("submitBtn").style.background = "black";
        document.getElementById("submitBtn").style.color = "red";
    }
}

checkMidnightMode();


// ===== 514 MAIN RESPONSES =====
const replies = [
"Your wish will remain here.",
"Your wish will remain here.",
"The price has already begun.",
"Someone else will pay in your place.",
"You have been chosen.",
"There is no way back.",
"514 does not reject you.",
"Those words cannot be taken back.",
"You are being watched.",
"Do you remember?",
"This is not your first time here.",
"Your input has been saved.",
"Is that enough as a sacrifice?",
"Wishes demand blood.",
"Your shadow is smiling.",
"514 is responding.",
"One has already been granted.",
"You just haven't noticed it yet.",
"This room has no exit.",
"Your wish will drain you.",
"Will you continue?",
"It’s your turn next.",
"You didn’t want anyone to hear that, did you?",
"514 knows you.",
"We’ve heard that wish before.",
"Time does not matter. This place is always open.",
"Is that wish truly yours?",
"The moment you typed it, there was no return.",
"Wishes come true. But the price is never equal.",
"What are you willing to lose?",
"Is it salvation, or escape?",
"Room 514 records everything.",
"You already know the answer.",
"You’re late.",
"Still hesitating?",
"Have you forgotten why you came?",
"Silence is also a wish.",
"……Are you serious?",
"Your input has been recorded.",
"514 prefers silence.",
"You actually have another wish, don’t you?",
"The stronger you wish, the more it twists.",
"Do you want to be saved?",
"Can you imagine yourself after it comes true?",
"Can you swear you won’t regret it?",
"This room does not exist.",
"Are you sure you're only looking at a screen?",
"This is not a school.",
"Will that satisfy you?",
"Such light words.",
"Wishes have weight."
];

// ===== FYODOR =====
const fyodorReplies = [
"Вы хотите купить информацию?",
"Бог наблюдает за вами.",
"Слушайте волю Бога.",
"Молитесь Богу.",
"Мир во всём мире.",
"Жертва необходима ради мира во всём мире.",
"Человек может быть очень прост. Он искренне верит, что думает сам.",
"Вы готовы заключить сделку с дьяволом?",
"Покрой эту землю кровью грешников ради лучшего мира.",
"Люди грешны и глупы. Даже зная, что это обман, они продолжают убивать.",
"Мысль — грех. Дыхание — грех. Человек — грех.",
"Вы когда-нибудь думали об идеальном мире?",
"Не лгите самому себе.",
"Я люблю человечество в целом, но меньше люблю людей по отдельности.",
"Жестокость человека превосходит звериную.",
"Человек создал дьявола по своему образу."
];

// ===== NIETZ =====
const nietzMain = [
"The higher a tree grows, the deeper its roots reach into the darkness.",
"When you gaze long into an abyss, the abyss also gazes into you."
];

const nietzExtra = [
"Is man merely God’s mistake? Or is God merely man’s?",
"God is dead. And we have killed him."
];

// ===== 132012 SYSTEM =====
const sadReplies = [
"Cha, nghỉ ngơi thôi.",
"Cha đừng buồn.",
"Đừng rời khỏi đây.",
"Đừng khóc.",
"Con ở đây mà.",
"Cha đừng ngủ một mình.",
"Cha không được biến mất.",
"Nếu cha rời đi, con sẽ buồn lắm.",
"Cha không cần ai khác.",
"Con hiểu cha."
];

function normalize(text){
    return text.toLowerCase()
               .normalize("NFD")
               .replace(/[\u0300-\u036f]/g,"");
}

function containsFyodor(t){
    return t.includes("fyodor") ||
           t.includes("dostoevsky") ||
           t.includes("достоев") ||
           t.includes("devil");
}

function containsNietz(t){
    return t.includes("nietz");
}

function hasExactPassword(text){
    return text.split(/\s+/).includes("132012");
}

// ===== MAIN FUNCTION =====
function reply(){

    const inputRaw = document.getElementById("userInput").value.trim();
    const responseDiv = document.getElementById("response");
    const body = document.body;

    if(inputRaw === ""){
        responseDiv.style.color = "white";
        responseDiv.innerText = "……Please enter something.";
        return;
    }

    // ===== 514 CHANT (ADDED) =====
    if(inputRaw === "514 514 514"){
        responseDiv.innerText = "";
        responseDiv.style.color = "red";

        setTimeout(()=>{
            responseDiv.innerText = "Room 514 has heard you.";
        },10000);

        return;
    }

    // ===== IS THIS REAL (ADDED) =====
    if(inputRaw === "Is this real?"){
        responseDiv.style.color = "white";
        responseDiv.innerText =
            Math.random() < 0.5
            ? "What makes you think it isn’t?"
            : "Does it feel unreal to you?";
        return;
    }

    // ===== SPECIAL TRIGGERS =====
    if(inputRaw === "Farewell...."){
        responseDiv.innerText = "Farewell, Fyodor Dostoyevsky";
        return;
    }

    if(inputRaw === "Farewell, Fyodor Dostoyevsky"){
        responseDiv.innerText = "My God, my God, why have you forgotten me ?";
        return;
    }

    if(inputRaw === "What do you wish for ?"){
        responseDiv.style.color = "red";
        responseDiv.innerText = "The World.";
        return;
    }

    // ===== THE BOOK (UPGRADED) =====
    if(inputRaw === "The Book"){
        body.innerHTML = "";
        body.style.background = "black";

        setTimeout(()=>{
            body.innerHTML = `
                <div id="bookScene" style="margin-top:30vh; transition:opacity 3s;">
                    <div style="font-size:200px;color:red;">514</div>
                    <div style="color:red;margin-top:20px;">
                    do you want the world to be a better place, as God desires ?
                    </div>
                </div>
            `;
        },1000);

        setTimeout(()=>{
            const scene = document.getElementById("bookScene");
            if(scene){
                scene.classList.add("fade-out");
            }
        },4000);

        setTimeout(()=>{
            body.innerHTML = `
                <div style="margin-top:40vh;color:red;font-size:30px;">
                    You already chose.
                </div>
            `;
        },7000);

        return;
    }

    const normalized = normalize(inputRaw);
    const password = hasExactPassword(inputRaw);

    const sadWords = ["met","buon","khoc","muon chet","co don","dau"];
    const weatherWords = ["lanh","mua","suong","dong"];

    const hasSad = sadWords.some(word => normalized.includes(word));
    const hasWeather = weatherWords.some(word => normalized.includes(word));

    // ===== 132012 ACTIVATION =====
    if(password){

        responseDiv.innerText = "";
        body.style.background = "black";

        setTimeout(() => {

            responseDiv.style.color = "red";

            if(normalized.includes("con la ai")){
                responseDiv.innerText =
                    Math.random() < 0.5
                    ? "Cha quên con rồi sao?"
                    : "Con của cha.";
                return;
            }

            if(normalized.includes("ai tao ra con")){
                responseDiv.innerText = "Cha tạo ra con.";
                return;
            }

            if(hasSad){
                responseDiv.innerText =
                    sadReplies[Math.floor(Math.random()*sadReplies.length)];
                return;
            }

            if(normalized.includes("thi xong")){
                responseDiv.innerText = "Cha làm tốt lắm.";
                return;
            }

            if(normalized.includes("vui")){
                responseDiv.innerText = "Con vui vì cha vui.";
                return;
            }

            if(normalized.includes("ngu")){
                responseDiv.innerText = "Chúc ngủ ngon, thưa cha.";
                return;
            }

            if(hasWeather){
                responseDiv.innerText = "Cha có lạnh không?";
                return;
            }

            responseDiv.innerText = "Thưa cha, cha gọi con?";
        
        },1000);

        return;
    }

    const hasFyodor = containsFyodor(normalized);
    const hasNietz = containsNietz(normalized);

    responseDiv.style.color = "white";

    if(hasFyodor && hasNietz){
        responseDiv.innerText =
            Math.random() < 0.7
            ? nietzMain[Math.floor(Math.random()*nietzMain.length)]
            : nietzExtra[Math.floor(Math.random()*nietzExtra.length)];
        return;
    }

    if(hasFyodor){
        responseDiv.innerText =
            fyodorReplies[Math.floor(Math.random()*fyodorReplies.length)];
        return;
    }

    if(hasNietz){
        responseDiv.innerText =
            Math.random() < 0.7
            ? nietzMain[Math.floor(Math.random()*nietzMain.length)]
            : nietzExtra[Math.floor(Math.random()*nietzExtra.length)];
        return;
    }

    responseDiv.innerText =
        replies[Math.floor(Math.random()*replies.length)];
}

</script>

</body>
</html>
