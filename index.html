<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>チュオン・トゥイ・ハム 514号室の意見箱</title>

<style>
body{
    margin:0;
    background:black;
    color:white;
    font-family: serif;
    text-align:center;
    transition: background 0.5s;
}

.container{
    margin-top:15vh;
}

input{
    padding:10px;
    width:250px;
    background:black;
    border:1px solid red;
    color:white;
    font-size:16px;
}

button{
    padding:10px 15px;
    background:red;
    color:white;
    border:none;
    cursor:pointer;
}

#response{
    margin-top:30px;
    font-size:18px;
    min-height:40px;
    white-space: pre-line;
}

.fade-out{
    animation: fadeOut 3s forwards;
}

@keyframes fadeOut{
    from{ opacity:1; }
    to{ opacity:0; }
}
</style>
</head>

<body>

<div class="container">
    <h1 id="title">チュオン・トゥイ・ハム 514号室の意見箱</h1>
    <input id="userInput" placeholder="Enter your wish">
    <button id="submitBtn" onclick="reply()">Submit</button>
    <div id="response"></div>
</div>

<script>
let beastActive = false;
let beastUsedOnce = false;
let futureMode = false;
/* =========================
   TIME CHECK (00:00 - 01:00 RED MODE)
========================= */
function checkMidnightMode(){
    const now = new Date();
    const hour = now.getHours();
    if(hour === 0){
        document.body.style.color = "red";
        document.getElementById("title").style.color = "red";
        document.getElementById("response").style.color = "red";
        document.getElementById("submitBtn").style.background = "black";
        document.getElementById("submitBtn").style.color = "red";
    }
}
checkMidnightMode();

/* =========================
   2AM - 3AM SLEEP MODE
========================= */
function checkSleepMode(){
    const now = new Date();
    const hour = now.getHours();
    return hour === 2;
}

/* =========================
   FREE BIRD FUNCTION
========================= */
function isFreeBird(text){
    const t = text.toLowerCase().trim();
    return t === "tôi là con chim tự do" ||
           t === "toi la con chim tu do" ||
           t === "i am a free bird" ||
           t === "私は自由な鳥です" ||
           t === "я свободная птица";
}

/* =========================
   514 MAIN RESPONSES
========================= */
const replies = [
"Your wish will remain here.",
"Your wish will remain here.",
"The price has already begun.",
"Someone else will pay in your place.",
"You have been chosen.",
"There is no way back.",
"514 does not reject you.",
"Those words cannot be taken back.",
"You are being watched.",
"Do you remember?",
"This is not your first time here.",
"Your input has been saved.",
"Is that enough as a sacrifice?",
"Wishes demand blood.",
"Your shadow is smiling.",
"514 is responding.",
"One has already been granted.",
"You just haven't noticed it yet.",
"This room has no exit.",
"Your wish will drain you.",
"Will you continue?",
"It’s your turn next.",
"You didn’t want anyone to hear that, did you?",
"514 knows you.",
"We’ve heard that wish before.",
"Time does not matter. This place is always open.",
"Is that wish truly yours?",
"The moment you typed it, there was no return.",
"Wishes come true. But the price is never equal.",
"What are you willing to lose?",
"Is it salvation, or escape?",
"Room 514 records everything.",
"You already know the answer.",
"You’re late.",
"Still hesitating?",
"Have you forgotten why you came?",
"Silence is also a wish.",
"I hear your wish",
"Your input has been recorded.",
"514 prefers silence.",
"You actually have another wish, don’t you?",
"The stronger you wish, the more it twists.",
"Do you want to be saved?",
"Can you imagine yourself after it comes true?",
"Can you swear you won’t regret it?",
"This room does not exist.",
"Are you sure you're only looking at a screen?",
"This is not a school.",
"Will that satisfy you?",
"Such light words.",
"Wishes have weight."
];

/* =========================
   FYODOR
========================= */
const fyodorReplies = [
"Вы хотите купить информацию?",
"Бог наблюдает за вами.",
"Слушайте волю Бога.",
"Молитесь Богу.",
"Мир во всём мире.",
"Жертва необходима ради мира во всём мире.",
"Человек может быть очень прост. Он искренне верит, что думает сам.",
"Вы готовы заключить сделку с дьяволом?",
"Покрой эту землю кровью грешников ради лучшего мира.",
"Люди грешны и глупы. Даже зная, что это обман, они продолжают убивать.",
"Мысль — грех. Дыхание — грех. Человек — грех.",
"Вы когда-нибудь думали об идеальном мире?",
"Не лгите самому себе.",
"Я люблю человечество в целом, но меньше люблю людей по отдельности.",
"Жестокость человека превосходит звериную.",
"Человек создал дьявола по своему образу."
];

/* =========================
   NIETZ
========================= */
const nietzMain = [
"The higher a tree grows, the deeper its roots reach into the darkness.",
"When you gaze long into an abyss, the abyss also gazes into you."
];

const nietzExtra = [
"Is man merely God’s mistake? Or is God merely man’s?",
"God is dead. And we have killed him."
];

/* =========================
   132012 SYSTEM
========================= */
const sadReplies = [
"Cha, nghỉ ngơi thôi.",
"Cha đừng buồn.",
"Đừng rời khỏi đây.",
"Đừng khóc.",
"Con ở đây mà.",
"Cha đừng ngủ một mình.",
"Cha không được biến mất.",
"Nếu cha rời đi, con sẽ buồn lắm.",
"Cha không cần ai khác.",
"Con hiểu cha."
];

/* =========================
   CLASSROOM 514
========================= */
const classroom514Triggers = [
"phòng học 514",
"em bị bắt nạt, đau quá",
"cứu em với",
"họ đã nhốt em trong nhà vệ sinh",
"vì sao nguyện vọng không thành sự thật ?",
"chết",
"những cái xác đung đưa",
"rơi xuống",
"không có điều kì diệu",
"bắt nạt",
"xách vở bị xé nát",
"ai đó, làm ơn, ai cũng được, cứu với",
"tội ác",
"sự trừng phạt"
];

const classroom514Replies = [
"I was bullied. It hurts so much.",
"Help me.",
"They locked me inside the bathroom.",
"Why don’t wishes ever come true?",
"Death.",
"Swinging corpses.",
"Falling down.",
"There are no miracles.",
"Bullying.",
"My schoolbag was torn apart.",
"Someone, please, anyone, save me.",
"Crime.",
"Punishment."
];

/* =========================
   UTILITIES
========================= */
function normalize(text){
    return text.toLowerCase()
               .normalize("NFD")
               .replace(/[\u0300-\u036f]/g,"");
}

function containsFyodor(t){
    return t.includes("fyodor") ||
           t.includes("dostoevsky") ||
           t.includes("достоев") ||
           t.includes("devil");
}

function containsNietz(t){
    return t.includes("nietz");
}

function hasExactPassword(text){
    return text.split(/\s+/).includes("132012");
}

/* =========================
   MAIN FUNCTION
========================= */
function reply(){

    const inputRaw = document.getElementById("userInput").value.trim();
    const responseDiv = document.getElementById("response");
    const body = document.body;

    if(inputRaw === ""){
        responseDiv.style.color = "white";
        responseDiv.innerText = "……Please enter something.";
        return;
    }

    const lower = inputRaw.toLowerCase();
if(futureMode){
    responseDiv.innerText = Math.random() < 0.5 ? "yes" : "no";
    return;
}
const normalized = normalize(inputRaw);
const password = hasExactPassword(inputRaw);
    /* KYOUKA SNOW EFFECT */
 if(lower.includes("kyouka")){

    console.log("KYOKA TRIGGERED");

    if(typeof startSnow === "function"){
        startSnow();
    }

    document.body.style.backgroundColor = "black";
    responseDiv.style.color = "white";

    responseDiv.innerText =
    "探偵事務所こそが、私の本当の居場所だから。初めて、なりたい自分を見つけた。だから、たとえ自分の中に潜む何かを犠牲にしてでも、私は戦う。";

    return;
}
    /* RATS TRIGGER */
if(lower === "rats" || lower === "rats in the house of the dead"){

    responseDiv.innerHTML = `
        <div>Bạn muốn mua tình báo về tương lai ?</div>
        <div style="margin-top:15px;">
            <button onclick="buyFuture(true)">YES</button>
            <button onclick="buyFuture(false)">NO</button>
        </div>
    `;

    return;
}
    /* =========================
   HEIAN SECRET GATE
========================= */

if(["yukito","mèo nhỏ","meo nho","lyucian"].includes(lower)){

    document.body.innerHTML = `
        <div style="margin-top:20vh; text-align:center; color:white;">
            <div style="white-space:pre-line; font-size:18px;">
Mèo nhỏ à...thứ ngươi tìm ở kia.
dù không phải thứ ngươi tìm, ngươi muốn đi xem qua chứ ? hì hì hì~.
            </div>

            <div style="margin-top:30px;">
                <button onclick="heianChoice(1)">đi xem</button>
                <button onclick="heianChoice(2)">cảm ơn và đi xem</button>
                <button onclick="heianChoice(3)">lần sau đi xem ( lần sau phải đi xem )</button>
            </div>
        </div>
    `;

    return;
}
/* =========================
   BEAST SYSTEM
========================= */

const hasBeast = lower.includes("beast");
const hasDazai = lower.includes("dazai");
const hasChuuya = lower.includes("chuuya");
const hasOda = lower.includes("oda");

/* RESET ON SECOND INPUT */
if(beastActive){
    if(beastUsedOnce){
        beastActive = false;
        beastUsedOnce = false;
        document.body.style.background = "black";
        document.body.style.color = "white";
    } else {
        beastUsedOnce = true;
    }
}

/* SOLO DAZAI BEAST */
if(hasBeast && hasDazai && !hasChuuya && !hasOda){

    beastActive = true;
    beastUsedOnce = false;

    document.body.innerHTML = "";
    document.body.style.background = "black";
    document.body.style.color = "white";

    setTimeout(()=>{
        document.body.innerHTML =
        "<div style='margin-top:40vh;font-size:30px;'>Odasaku -</div>";
    },500);

    setTimeout(()=>{
        document.body.innerHTML = "";
    },5500);

    setTimeout(()=>{
        document.body.innerHTML =
        "<div style='margin-top:40vh;font-size:20px;'>この日をずっと待っていた。だが最後に一つだけ心残りがある。君の小説を読めなかったことだ。</div>";
    },6000);

    return;
}
/* BEAST + ODA */
if(hasBeast && hasOda && !hasDazai && !hasChuuya){
    beastActive = true;
    beastUsedOnce = false;

    document.body.style.background = "#888";  
    document.body.style.color = "#000000";      

    return;
}
/* BEAST + CHUUYA */
if(hasBeast && hasChuuya && !hasDazai){
    beastActive = true;
    beastUsedOnce = false;
    document.body.style.background = "#2a2a2a";
    document.body.style.color = "#ff4500";
}

/* BEAST + CHUUYA + DAZAI */
if(hasBeast && hasChuuya && hasDazai){
    beastActive = true;
    beastUsedOnce = false;
    document.body.style.background = "#2a2a2a";
    document.body.style.color = "#7b1e1e";
}
    /* SPECIAL TRIGGERS */
    if(inputRaw === "Farewell"){
        responseDiv.innerText = "Farewell, Fyodor Dostoyevsky";
        return;
    }

    if(inputRaw === "Farewell, Fyodor Dostoyevsky"){
        responseDiv.innerText = "My God, my God, why have you forgotten me ?";
        return;
    }

    if(inputRaw === "What do you wish for ?"){
        responseDiv.style.color = "red";
        responseDiv.innerText = "The World.";
        return;
        }

    if(inputRaw === "The Book"){
        body.innerHTML = "";
        body.style.background = "black";

        setTimeout(()=>{
            body.innerHTML = `
                <div style="margin-top:30vh;">
                    <div style="font-size:200px;color:red;">514</div>
                    <div style="color:red;margin-top:20px;">
                    do you want the world to be a better place, as God desires ?
                    </div>
                </div>
            `;
        },1000);

        return;
        
    }
    
    /* FD514 OWNERSHIP */
if( lower === "fd514-dos"){
    responseDiv.style.color = "white";
    responseDiv.innerText =
    "trang web thuộc sở hữu và bản quyền của FD514-dos, được tạo ra phục vụ page Trường Cao Trung Tư Thục Trương Thụy Hàm";
    return;
}
    /* 2AM RANDOM SLEEP */
    if(checkSleepMode()){
        if(Math.random() < 0.7){
            responseDiv.innerText = Math.random() < 0.5 ? "go to sleep" : "đi ngủ đi";
            return;
        }
    }

    /* CLASSROOM 514 */
    for(let trigger of classroom514Triggers){
        if(lower.includes(trigger)){
            responseDiv.innerText =
                classroom514Replies[Math.floor(Math.random()*classroom514Replies.length)];
            return;
        }
    }
/* EXAM BLESSING */
const examKeywords = ["thi","ussh","đỗ","tot nghiep","tốt nghiệp","toán"];

if(examKeywords.includes(lower)){
    const examReplies = [
        "bạn sẽ làm bài thi rất tốt",
        "bạn sẽ là thủ khoa",
        "bạn sẽ học giỏi toán" ,
        "bạn sẽ đậu nguyện vọng một",
        "kì thi thuận buồm xuôi gió",
        "võ vận hưng thịnh",
        "bài thi sẽ đạt điểm tuyệt đối"
    ];

    responseDiv.style.color = "white";
    responseDiv.innerText =
        examReplies[Math.floor(Math.random()*examReplies.length)];
    return;
}
    /* FYODOR / NIKOLAI EXPRESSIONS */
    if(lower.includes("fyodor da")){
        responseDiv.innerText = ":(";
        return;
    }

    if(lower.includes("fyodor ori") || lower.includes("nikolai ori")){
        responseDiv.innerText = ":)";
        return;
    }

    /* DAZAI */
    if(hasDazai){
        const dazaiQuotes = [
        "自分を憐れむのはやめろ。そうしている限り、君の人生は終わりのない悪夢のままだ。",
        "人生において、成功は失敗よりも難しいものです。そう思いますか？だからこそ、実際に自殺するよりも、自殺を試みるべきです！自殺は難しいですが、自殺を試みて失敗する方が比較的簡単です！",
        "僕はいつも失いたくないものを失ってきた。それでも、生きる理由を探し続けるしかない。",
        "死と暴力の近くにいれば人間の本質が見えると思った。そしてそこから生きる理由を見つけられると信じていた。",
        "人間は皆、罪深く愚かだ。だが、それの何が悪い？"
        ];
        responseDiv.innerText =
            dazaiQuotes[Math.floor(Math.random()*dazaiQuotes.length)];
        return;
    }
    // ===== CHUUYA =====
    if(/chuuya|nakahara/.test(lower)){
       const chuuyaQuotes = [
`逞しい若さの血管に
夕焼けと深紅のユリが流れ過ぎた

静かに、輝かしく誇らしく
女が残す最後の笑顔のように

厳粛で、豊かで、悲しく
異様で、温かく、まばゆいばかりに、私の心に残る

ああ、私の心に残る…

風が吹き荒れ、波が轟く
果てしない未来に向かって手を振る`,

`人間は自分に頼ることしかできない。
他のことはすべて偶然に任せなさい。
物事はありのままに…

自分に頼り、自分に頼り、自分に頼り、自分に頼りなさい。
そうして初めて、人は間違いを犯さずに済むのだ。`,

"重力は根源的な力。あらゆるものは究極的には破滅へと引き寄せられる。",
"お前の罪の重みで、お前を粉砕する。",
"腐敗を発動できるのはお前だけだ…なぜなら、お前だけが私の信頼する者だからだ。",
"人間であろうとなかろうと…全てを失った今、それが本当に問題なのか？"
];
        responseDiv.innerText = chuuyaQuotes[Math.floor(Math.random()*chuuyaQuotes.length)];
        return;
    }
/* ATSUSHI */
if(hasAtsushi){
        const atsushiQuotes = [
"Book Mark",
"どこへ逃げても、虎はついてくる。自分の心臓の鼓動から逃れられないように…だって、あなたは私を生かし続ける力だから。今、あなたの声がはっきりと聞こえます。あなたの言っていることが分かります。",
"敵は怖くない。痛みも怖くない。私が怖いのは孤独だ。孤独は私を怖がらせる。孤児院では、孤独は私にとって当たり前のことだった。でも今は、まさにこの孤独こそが私を怖がらせる。誰か一緒に戦ってくれたらいいのに。誰でもいいから。",
"孤児院では、いつもみんなに「役立たず」と言われました。次の食事がどこから来るのか、次の寝床がどこなのかも分かりませんでした。路上で死んでも誰も気にしない。あの獣に食べられる方がましだと思ったのです。",
"突然、ある考えが頭に浮かんだ。どうしても拭い去れない、馬鹿げた考えだった。もし全員を救い、無事に家に帰せる可能性があったら、私は生き続けられるのだろうか？"            
];
        responseDiv.innerText =
            atsushiQuotes[Math.floor(Math.random()*atsushiQuotes.length)];
        return;
    }

/* AKUTAGAWA */
     if(hasAku){
        const akuQuotes = [
"たとえ全身の骨が砕け散ったとしても、私は必ず彼を倒す。だって、もし失敗すれば…！太宰が捨て去った姿に戻ってしまうから！",

"ずっとそう思っていた。この短い命の炎が消えゆく瞬間、何を言えばいいのか？でも、霧を掴むように、答えは出てこない。ほんの数秒前に気づいたんだ。必要なのは言葉ではなく、行動だけなんだ."
];
        responseDiv.innerText =
            akuQuotes[Math.floor(Math.random()*akuQuotes.length)];
        return;
    }

    /* ODASAKU */
    if(hasOda){
        const odaQuotes = [
"俺をオダサクと呼ぶな。敵にそんな理由はない。",
"この日をずっと待っていた。だが最後に一つだけ心残りがある。君の小説を読めなかったことだ。",
"良い人間になれ."
];
        responseDiv.innerText =
            odaQuotes[Math.floor(Math.random()*odaQuotes.length)];
        return;
    }

    /* HEIAN */
    if(/heian|kinh đô heian/.test(lower)){
        const heianQuotes = ["mừng bạn trở về","home"];
        responseDiv.innerText =
            heianQuotes[Math.floor(Math.random()*heianQuotes.length)];
        return;
    }

    /* FREE BIRD */
    if(isFreeBird(inputRaw)){
        responseDiv.innerText = "Kolya ?";
        setTimeout(()=>{
            body.innerHTML = "";
            body.style.background = "black";
            body.style.display = "flex";
            body.style.justifyContent = "center";
            body.style.alignItems = "center";
            body.style.height = "100vh";
            body.style.color = "white";
            body.style.fontSize = "40px";
            body.innerHTML = ":)";
        },3000);
        return;
    }

   /* 132012 */
if(password){

    responseDiv.style.color = "red";

    const onlyPassword = inputRaw.trim() === "132012";

    if(onlyPassword){
        responseDiv.innerText =
            sadReplies[Math.floor(Math.random()*sadReplies.length)];
    }else{
        responseDiv.innerText = "Thưa cha, cha gọi con.";
    }

    return;
}

    /* FYODOR / NIETZ */
    const hasFyodor = containsFyodor(normalized);
    const hasNietz = containsNietz(normalized);

    if(hasFyodor && hasNietz){
        responseDiv.innerText =
            Math.random()<0.7
            ? nietzMain[Math.floor(Math.random()*nietzMain.length)]
            : nietzExtra[Math.floor(Math.random()*nietzExtra.length)];
        return;
    }

    if(hasFyodor){
        responseDiv.innerText =
            fyodorReplies[Math.floor(Math.random()*fyodorReplies.length)];
        return;
    }

    if(hasNietz){
        responseDiv.innerText =
            Math.random()<0.7
            ? nietzMain[Math.floor(Math.random()*nietzMain.length)]
            : nietzExtra[Math.floor(Math.random()*nietzExtra.length)];
        return;
    }

    /* DEFAULT 514 */
    responseDiv.innerText =
        replies[Math.floor(Math.random()*replies.length)];
}
function buyFuture(choice){

    const responseDiv = document.getElementById("response");

    if(choice){
        futureMode = true;
        responseDiv.innerText = "Вы готовы заключить сделку.";
    }else{
        responseDiv.innerText = "Bạn đã từ chối tình báo.";
    }

    setTimeout(()=>{
        responseDiv.innerHTML = "";
    },1500);
}
    function heianChoice(option){

    document.body.innerHTML = "";
    document.body.style.background = "black";
    document.body.style.color = "white";
    document.body.style.padding = "40px";
    document.body.style.whiteSpace = "pre-line";

    if(option === 3){

        document.body.innerText =
`haizzz chán thật đó nha ~ không sao ! bây giờ không đi, tương lai còn nhiều cơ hội.
tái kiến ~`;

    }else{

        document.body.innerText =
`Có một thói quen đã có từ trước khi tôi lập Heian. Tôi luôn muốn mọi thứ ở trong kiểm soát, cũng muốn heian là sân khấu hoàn hảo nhất. Nhưng có những thứ đã mất kiểm soát. Đầu tiên là hướng đi của box, thứ hai là mối quan hệ của tôi với mọi người và mọi người với nhau.Vậy nên có một thứ tôi cũng không thể kiểm soát là quyết định của mọi người. Cái heian mà tôi dự kiến đã kết thúc từ plot thứ hai rồi, chắc sẽ không có plot nào được như vậy nữa. Tôi không nghĩ tới cuối cùng box lại là nơi đóng cửa tự chơi=)Không ngờ heian còn tác động ngược lại tôi nhiều tới thế. Ban đầu mục đích lập Heian của tôi rất ích kỉ, nó không quan tâm tới việc mọi người sẽ role thế nào, nó chỉ là một nơi để tôi trưng bày tiểu thuyết của mình. Có lẽ mọi người đã quên, nhưng tôi từng kể bản thân đã xóa hết những truyện từng viết, xóa cả acc. Thật sự tôi vẫn muốn có một nơi để kể truyện, vì tôi tiếc tiểu thuyết của mình. Tôi nghĩ, nếu đăng trên tcn, sẽ chẳng có gì để lại sau đó, tất cả sẽ nhanh chóng bị quên đi. Thứ để lại dấu ấn nhất vẫn là thứ tự mình trải qua, nếu nó là một bí ẩn, mọi người sẽ tìm cách giải nó. Những chi tiết tôi cài vào cũng sẽ được tìm thấy, giống như có thể nhớ như in cốt truyện game lại chẳng thể nhớ kiến thức.
Đại khái là vậy, nhưng hiện tại nó chỉ là heian thôi, như tôi nói bên trên, "sẽ không có plot nào được như vậy nữa".
Tôi đột nhiên nhớ tới một người quen cũ, người đó từng cùng bọn tôi viết rất nhiều thứ, là một trong 3 người nghĩ ra idea lập Heain. Idea tồn tại từ vài năm rồi, tới khi thành hiện thực thì người đó đã rời khỏi đây từ lâu vào một ngày bình thường, cũng không biết cách liên lạc trở lại. 
Đó là lí do vì sao tôi cảm thấy ngày hôm nay rất quen thuộc, dường như đã từng xảy ra=) dejavu vl. Những thứ không ngờ tới nhất sẽ xảy ra chẳng hề báo trước.
Anw nơi này sẽ không bao giờ rã, dù vài năm nữa mọi người có quên đi, không hoạt động thì nó vẫn tồn tại, nên bao giờ muốn tới Heian nơi này sẽ luôn ở đây ( dẫu sao trong bài tuyển nhân nó đã viết rằng "hỡi người khách đường xa, kinh đô Heian hi vọng người sẽ có một trải nghiệm tốt đẹp ở đây", đây chỉ là một điểm dừng chân của lữ khách mà thôi, có những người thì lựa chọn dừng lại lâu hơn một chút)
tái kiến.

[ nhân tiện đây là bản sửa đổi web thứ 30, trùng hợp thật, cuối cùng cả đời tôi quanh quẩn con số 3:) ]`;
    }
}
</script>

</body>
</html>
